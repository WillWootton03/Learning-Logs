{% extends 'base.html' %}
{% load static tailwind_tags %}
{% block content %}
    <!--Section for all tags-->
    <div id="page-wrapper" class="flex flex-box mx-auto pt-24 justify-center h-[calc(100vh-3rem)] w-[60%] transition-all duration-200">
        <div class="px-6 py-8 relative h-full w-full flex flex-col items-center">
            <div class="h-full w-[90%] bg-amber-200 flex flex-col items-center gap-y-2">
                <!--Acts as the Concept tag headers with search-->
                <div class="flex flex-col items-center gap-y-2 w-[70%]">
                    <h1 class="py-1  text-black text-2xl font-bold">Concept Tags</h1>
                    <input id="tag-search" placeholder="Search Tag" class="w-[80%] h-8 text-lg text-center bg-green-700 border-2 border-black" />
                </div>
                <!--Acts as the box for all concept tags-->
                <div class="h-full w-full flex flex-col items-center gap-y-3 ">
                    <div class="h-64 w-[90%] bg-green-400 flex flex-col">
                        <h2 class="text-2xl text-white text-center">Selected Tags</h2>
                        <div class="bg-gray-500 h-full w-full overflow-y-auto">
                            <div class="grid grid-cols-4 gap-x-2 gap-y-3 m-1">
                            {% for tag in concept.tags.all %}
                                <button class="bg-blue-200 rounded-2xl w-full h-8">{{ tag.name }}</button>
                            {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="h-64 w-[90%] mb-2 bg-blue-400 flex flex-col">
                        <h2 class="text-2xl text-white text-center">Available Tags</h2>
                        <div class="bg-gray-500 h-full w-full overflow-y-auto">
                            <div class="grid grid-cols-4 gap-x-2 gap-y-3 m-1">
                                {% for tag in board.tags.all %}
                                    <button class="bg-blue-200 rounded-2xl w-full h-8">{{ tag.name }}</button>
                                {% endfor%}
                            </div>
                        </div>
                    </div>
                </div>
                <button id="new-tag" class="bg-blue-300 font-bold px-20 py-2 text-2xl rounded-2xl mb-3 flex flex-col">Create A New Tag</button>
            </div>
                <button class="bg-gray-600 px-20 py-3 text-2xl rounded-2xl mt-3 flex flex-col">Submit</button>
        </div>
    </div>

    <!--Acts as the blurred background to cover main page-->
    <div id="tag-backdrop" class="hidden fixed inset-0 z-90 bg-black/50 backdrop-blur-sm"></div>
    <!--Main modal for adding a tag-->
    <div id="new-tag-modal" class="hidden flex flex-row fixed inset-x-[25%] inset-y-[40%] w-[50%] h-[5vw] rounded-2xl bg-gray-500 z-100">
        <form method="POST" action="{% url 'setTags' board_id=board.id concept_id=concept.id%}" class="flex flex-row h-full w-full">
            {% csrf_token %}
            <!--Tag Title-->
            <div class="bg-white rounded-2xl p-3 w-[45%] h-[80%] shadow-xl m-2 content-center">
                {{ form.name }}
            </div>
            <!--Icon Capability for tags-->
            <div class="bg-white rounded-2xl p-3 w-[10%] h-[80%] shadow-xl m-2 content-center">
                <h2 class="text-2xl font-bold">Img</h2>
            </div>
            <!--Confirm and Add the tag to list of tags-->
            <button type="submit" class="bg-white rounded-2xl p-3 w-[30%] h-[80%] shadow-xl m-2 content-center text-2xl font-bold">
                Confirm
            </button>
            <button type="button" id="close-tag-modal" class="absolute top-3 right-3 bg-red-600 rounded-2xl px-2.5 py-1">X</button>
        </form>
    </div>
    <script>
        const pageWrapper = document.getElementById('page-wrapper');
        const tagBackdrop = document.getElementById('tag-backdrop');
        const newTagModal = document.getElementById('new-tag-modal');

        const closeTag = document.getElementById('close-tag-modal');

        const newTag = document.getElementById('new-tag');

        function openModal() {
            pageWrapper.classList.add('blur-sm', 'pointer-events-none')
            newTagModal.classList.remove('hidden')
            tagBackdrop.classList.remove('hidden')
        }

        function closeModal() {
            pageWrapper.classList.remove('blur-sm', 'pointer-events-none')
            newTagModal.classList.add('hidden')
            tagBackdrop.classList.add('hidden')
        }

        // Event Listener to the Create new tag button
        newTag.addEventListener('click', () => {
            openModal();
        });
        // Event Listener to the X button inside the modal
        closeTag.addEventListener('click', () => {
            closeModal();
        })
        // Event Listener to trigger closing the modal when clicking outside of the modal
        tagBackdrop.addEventListener('click', () => {
            if(!tagBackdrop.classList.contains('hidden')){
                closeModal();
            }
        })
    </script>
{% endblock %}